# ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ 500 –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è - –ó–ê–í–ï–†–®–ï–ù–û

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Å–ø—Ä–æ–±—ñ –æ—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤–∏–Ω–∏–∫–∞–ª–∞ –ø–æ–º–∏–ª–∫–∞:

```
POST http://localhost:3001/api/order 500 (Internal Server Error)
Failed to submit order: Error: Internal server error
```

## üîç –ü—Ä–∏—á–∏–Ω–∞

1. **–í—ñ–¥—Å—É—Ç–Ω—ñ –∫–æ–ª–æ–Ω–∫–∏ –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö** - `product_name` —Ç–∞ `product_price` –Ω–µ —ñ—Å–Ω—É–≤–∞–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü—ñ `order_items`
2. **NOT NULL –æ–±–º–µ–∂–µ–Ω–Ω—è** - –ø—ñ—Å–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–ª–æ–Ω–æ–∫ –≤–æ–Ω–∏ –º–∞–ª–∏ NOT NULL –æ–±–º–µ–∂–µ–Ω–Ω—è, –∞–ª–µ –∫–æ–¥ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–≤ —Ü—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
3. **–ù–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Ç–∏–ø—ñ–≤** - TypeScript —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª–∏ —Ä–µ–∞–ª—å–Ω—ñ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è

### 1. –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ö–µ–º–∏ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

–ö–æ–ª–æ–Ω–∫–∏ `product_name` —Ç–∞ `product_price` –≤–∂–µ –±—É–ª–∏ –¥–æ–¥–∞–Ω—ñ –¥–æ —Ç–∞–±–ª–∏—Ü—ñ `order_items` –∑ NOT NULL –æ–±–º–µ–∂–µ–Ω–Ω—è–º–∏.

### 2. –û–Ω–æ–≤–ª–µ–Ω–Ω—è TypeScript —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ–≤

```typescript
// src/lib/supabase.ts
export interface OrderItem {
  id: string;
  order_id: string;
  product_id: string | null;
  product_name: string; // ‚úÖ –î–æ–¥–∞–Ω–æ
  product_price: number; // ‚úÖ –î–æ–¥–∞–Ω–æ
  quantity: number;
  price: number;
  product?: Product;
}

// src/services/orders.ts
export interface CreateOrderData {
  // ... existing fields
  items: {
    product_id: string | null;
    product_name?: string; // ‚úÖ –î–æ–¥–∞–Ω–æ
    product_price?: number; // ‚úÖ –î–æ–¥–∞–Ω–æ
    quantity: number;
    price: number;
  }[];
}
```

### 3. –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ª–æ–≥—ñ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω—å

```typescript
// src/app/api/order/route.ts
items: orderData.items.map((item) => ({
  product_id: null,
  product_name: item.name,     // ‚úÖ –ù–∞–∑–≤–∞ –∑ –∫–æ—à–∏–∫–∞
  product_price: item.price,   // ‚úÖ –¶—ñ–Ω–∞ –∑ –∫–æ—à–∏–∫–∞
  quantity: item.quantity,
  price: item.price,
})),

// src/services/orders.ts
const orderItems = orderData.items.map((item) => ({
  order_id: order.id,
  product_id: item.product_id,
  product_name: item.product_name || "Unknown Product",  // ‚úÖ –ó fallback
  product_price: item.product_price || item.price,       // ‚úÖ –ó fallback
  quantity: item.quantity,
  price: item.price,
}));
```

### 4. –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó

- –í–∏–¥–∞–ª–µ–Ω–æ –Ω–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ —ñ–º–ø–æ—Ä—Ç–∏
- –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ —Ç–∏–ø–∏ `any` –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ç–∏–ø–∏
- –û—á–∏—â–µ–Ω–æ –∫–æ–¥ –≤—ñ–¥ –∑–∞–π–≤–∏—Ö –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è OrderService:

```
‚úÖ Order created successfully!
Order ID: 71d99da4-a94e-40f9-ada7-a06711a5cc54
Customer: –¢–µ—Å—Ç –¢–µ—Å—Ç–æ–≤–∏—á
Items: 1
Order items with product names:
  Item 1:
    Product Name: PowerMax 20000–º–ê–≥ –®–≤–∏–¥–∫–∞ –ó–∞—Ä—è–¥–∫–∞
    Product Price: 1000
    Quantity: 2
    Total: 1000
üéâ OrderService test completed successfully!
```

## üìä –ü–æ—Ç–æ—á–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö

### –¢–∞–±–ª–∏—Ü—è `order_items`:

- ‚úÖ `id` - UUID (–ø–µ—Ä–≤–∏–Ω–Ω–∏–π –∫–ª—é—á)
- ‚úÖ `order_id` - ID –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (–∑–≤'—è–∑–æ–∫)
- ‚úÖ `product_id` - ID —Ç–æ–≤–∞—Ä—É (–º–æ–∂–µ –±—É—Ç–∏ NULL)
- ‚úÖ `product_name` - **–ù–∞–∑–≤–∞ —Ç–æ–≤–∞—Ä—É –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–∫—É–ø–∫–∏**
- ‚úÖ `product_price` - **–¶—ñ–Ω–∞ —Ç–æ–≤–∞—Ä—É –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–∫—É–ø–∫–∏**
- ‚úÖ `quantity` - –ö—ñ–ª—å–∫—ñ—Å—Ç—å
- ‚úÖ `price` - –ó–∞–≥–∞–ª—å–Ω–∞ —Ü—ñ–Ω–∞
- ‚úÖ `created_at` - –î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è

## üéØ –ü–µ—Ä–µ–≤–∞–≥–∏ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

### 1. **–Ü—Å—Ç–æ—Ä–∏—á–Ω–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å**

- –ù–∞–∑–≤–∏ —Ç–æ–≤–∞—Ä—ñ–≤ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–∫—É–ø–∫–∏
- –ó–º—ñ–Ω–∏ –≤ –∫–∞—Ç–∞–ª–æ–∑—ñ –Ω–µ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ —ñ—Å—Ç–æ—Ä—ñ—é –∑–∞–º–æ–≤–ª–µ–Ω—å

### 2. **–ù–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ —Ç–∞–±–ª–∏—Ü—ñ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤**

- –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –º–æ–∂—É—Ç—å —ñ—Å–Ω—É–≤–∞—Ç–∏ –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Ç–æ–≤–∞—Ä –≤–∏–¥–∞–ª–µ–Ω–∏–π
- –ú–µ–Ω—à–µ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π –º—ñ–∂ —Ç–∞–±–ª–∏—Ü—è–º–∏

### 3. **–ü–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è**

- –í—Å—ñ –¥–∞–Ω—ñ –ø—Ä–æ —Ç–æ–≤–∞—Ä –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ
- –õ–µ–≥—à–µ –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é –ø—Ä–æ–¥–∞–∂—ñ–≤

### 4. **–°—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å API**

- –ü–æ–º–∏–ª–∫–∞ 500 –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∞
- API –ø—Ä–∞—Ü—é—î –Ω–∞–¥—ñ–π–Ω–æ

## üîß –î–æ—Å—Ç—É–ø–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

- `npm run test:supabase` - –¢–µ—Å—Ç –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ Supabase
- `npm run check:order-items` - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ö–µ–º–∏ —Ç–∞–±–ª–∏—Ü—ñ order_items
- `npm run dev` - –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Ä–æ–∑—Ä–æ–±–∫–∏

## ‚úÖ –°—Ç–∞—Ç—É—Å

- ‚úÖ **–ü–æ–º–∏–ª–∫–∞ 500 –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∞**
- ‚úÖ **API –ø—Ä–∞—Ü—é—î —Å—Ç–∞–±—ñ–ª—å–Ω–æ**
- ‚úÖ **–ù–∞–∑–≤–∏ —Ç–æ–≤–∞—Ä—ñ–≤ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è**
- ‚úÖ **–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è —É—Å–ø—ñ—à–Ω–æ**
- ‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω–∞**
- ‚úÖ **TypeScript —Ç–∏–ø–∏ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ**
- ‚úÖ **–ö–æ–¥ –æ—á–∏—â–µ–Ω–æ –≤—ñ–¥ –ø–æ–º–∏–ª–æ–∫**

## üöÄ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä**: `npm run dev`
2. **–ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è** —á–µ—Ä–µ–∑ UI
3. **–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–∑–≤ —Ç–æ–≤–∞—Ä—ñ–≤** –≤ Supabase Dashboard
4. **–û–Ω–æ–≤–∏—Ç–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω—å** (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

---

**–î–∞—Ç–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è**: 5 —Å—ñ—á–Ω—è 2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ü–û–í–ù–Ü–°–¢–Æ –í–ò–ü–†–ê–í–õ–ï–ù–û**  
**–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è**: ‚úÖ **–ü–†–û–ô–î–ï–ù–û**
