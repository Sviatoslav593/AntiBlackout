<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–¢–µ—Å—Ç –ø–µ—Ä–µ–¥–∞—á—ñ –¥–∞–Ω–∏—Ö –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      h1 {
        color: #333;
        text-align: center;
        margin-bottom: 30px;
      }
      .test-section {
        margin-bottom: 30px;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background-color: #fafafa;
      }
      .test-title {
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 18px;
      }
      .test-case {
        margin-bottom: 15px;
        padding: 10px;
        background: white;
        border-radius: 5px;
        border-left: 4px solid #3498db;
      }
      .test-input {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-bottom: 5px;
      }
      .test-button {
        background-color: #3498db;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin-right: 10px;
      }
      .test-button:hover {
        background-color: #2980b9;
      }
      .result {
        margin-top: 15px;
        padding: 10px;
        background-color: #e8f5e8;
        border-radius: 4px;
        border-left: 4px solid #27ae60;
      }
      .error {
        background-color: #f8d7da;
        border-left-color: #e74c3c;
      }
      pre {
        background-color: #f8f9fa;
        padding: 10px;
        border-radius: 4px;
        overflow-x: auto;
        font-size: 12px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üß™ –¢–µ—Å—Ç –ø–µ—Ä–µ–¥–∞—á—ñ –¥–∞–Ω–∏—Ö –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h1>

      <div class="test-section">
        <div class="test-title">üìù –¢–µ—Å—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–∞–Ω–∏—Ö</div>
        <div class="test-case">
          <h3>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h3>
          <button class="test-button" onclick="createTestData()">
            –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ
          </button>
          <button class="test-button" onclick="testURLEncoding()">
            –¢–µ—Å—Ç –∫–æ–¥—É–≤–∞–Ω–Ω—è URL
          </button>
          <button class="test-button" onclick="testLocalStorage()">
            –¢–µ—Å—Ç localStorage
          </button>
          <div id="result" class="result" style="display: none"></div>
        </div>
      </div>

      <div class="test-section">
        <div class="test-title">üîó –¢–µ—Å—Ç URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤</div>
        <div class="test-case">
          <h3>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤</h3>
          <button class="test-button" onclick="checkURLParams()">
            –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ URL
          </button>
          <button class="test-button" onclick="simulateOrderSuccess()">
            –°–∏–º—É–ª—é–≤–∞—Ç–∏ order-success
          </button>
          <div id="urlResult" class="result" style="display: none"></div>
        </div>
      </div>

      <div class="test-section">
        <div class="test-title">üíæ –¢–µ—Å—Ç localStorage</div>
        <div class="test-case">
          <h3>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ localStorage</h3>
          <button class="test-button" onclick="saveToLocalStorage()">
            –ó–±–µ—Ä–µ–≥—Ç–∏ –≤ localStorage
          </button>
          <button class="test-button" onclick="loadFromLocalStorage()">
            –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ localStorage
          </button>
          <button class="test-button" onclick="clearLocalStorage()">
            –û—á–∏—Å—Ç–∏—Ç–∏ localStorage
          </button>
          <div id="storageResult" class="result" style="display: none"></div>
        </div>
      </div>
    </div>

    <script>
      // –¢–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
      const testOrderData = {
        orderId: "AB-1234567890",
        items: [
          {
            id: 1,
            name: "PowerMax 20000–º–ê–≥ –®–≤–∏–¥–∫–∞ –ó–∞—Ä—è–¥–∫–∞",
            price: 2999,
            quantity: 1,
            image:
              "https://images.unsplash.com/photo-1609592094914-3ab0e6d1f0f3?w=300&h=300&fit=crop",
          },
          {
            id: 2,
            name: "–ö–∞–±–µ–ª—å USB-C 2m",
            price: 199,
            quantity: 2,
            image:
              "https://images.unsplash.com/photo-1558618666-5c0c2c7e7985?w=300&h=300&fit=crop",
          },
        ],
        customerInfo: {
          name: "–Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
          firstName: "–Ü–≤–∞–Ω",
          lastName: "–ü–µ—Ç—Ä–µ–Ω–∫–æ",
          phone: "+380671234567",
          email: "ivan@example.com",
          address: "–º. –ö–∏—ó–≤, –í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è ‚Ññ1: –≤—É–ª. –•—Ä–µ—â–∞—Ç–∏–∫, 1",
          paymentMethod: "cash_on_delivery",
          city: "–º. –ö–∏—ó–≤",
          warehouse: "–í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è ‚Ññ1: –≤—É–ª. –•—Ä–µ—â–∞—Ç–∏–∫, 1",
        },
        total: 3397,
        subtotal: 3397,
        paymentMethod: "cash_on_delivery",
        city: "–º. –ö–∏—ó–≤",
        warehouse: "–í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è ‚Ññ1: –≤—É–ª. –•—Ä–µ—â–∞—Ç–∏–∫, 1",
      };

      function createTestData() {
        const result = document.getElementById("result");
        result.style.display = "block";
        result.className = "result";
        result.innerHTML = `
                <h4>‚úÖ –¢–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ —Å—Ç–≤–æ—Ä–µ–Ω–æ:</h4>
                <pre>${JSON.stringify(testOrderData, null, 2)}</pre>
            `;
      }

      function testURLEncoding() {
        try {
          const encodedData = encodeURIComponent(JSON.stringify(testOrderData));
          const url = `/order-success?orderData=${encodedData}&orderNumber=${testOrderData.orderId}`;

          const result = document.getElementById("result");
          result.style.display = "block";
          result.className = "result";
          result.innerHTML = `
                    <h4>‚úÖ URL –∫–æ–¥—É–≤–∞–Ω–Ω—è —É—Å–ø—ñ—à–Ω–µ:</h4>
                    <p><strong>URL:</strong> <code>${url}</code></p>
                    <p><strong>–î–æ–≤–∂–∏–Ω–∞:</strong> ${url.length} —Å–∏–º–≤–æ–ª—ñ–≤</p>
                    <h5>–î–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è:</h5>
                    <pre>${JSON.stringify(
                      JSON.parse(decodeURIComponent(encodedData)),
                      null,
                      2
                    )}</pre>
                `;
        } catch (error) {
          const result = document.getElementById("result");
          result.style.display = "block";
          result.className = "result error";
          result.innerHTML = `
                    <h4>‚ùå –ü–æ–º–∏–ª–∫–∞ –∫–æ–¥—É–≤–∞–Ω–Ω—è URL:</h4>
                    <p>${error.message}</p>
                `;
        }
      }

      function testLocalStorage() {
        try {
          localStorage.setItem("testOrderData", JSON.stringify(testOrderData));
          const retrieved = JSON.parse(localStorage.getItem("testOrderData"));

          const result = document.getElementById("result");
          result.style.display = "block";
          result.className = "result";
          result.innerHTML = `
                    <h4>‚úÖ localStorage —Ç–µ—Å—Ç —É—Å–ø—ñ—à–Ω–∏–π:</h4>
                    <p>–î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–æ —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∑ localStorage</p>
                    <pre>${JSON.stringify(retrieved, null, 2)}</pre>
                `;
        } catch (error) {
          const result = document.getElementById("result");
          result.style.display = "block";
          result.className = "result error";
          result.innerHTML = `
                    <h4>‚ùå –ü–æ–º–∏–ª–∫–∞ localStorage:</h4>
                    <p>${error.message}</p>
                `;
        }
      }

      function checkURLParams() {
        const urlParams = new URLSearchParams(window.location.search);
        const orderData = urlParams.get("orderData");
        const orderNumber = urlParams.get("orderNumber");

        const result = document.getElementById("urlResult");
        result.style.display = "block";

        if (orderData || orderNumber) {
          result.className = "result";
          result.innerHTML = `
                    <h4>‚úÖ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑–Ω–∞–π–¥–µ–Ω–æ:</h4>
                    <p><strong>orderData:</strong> ${
                      orderData ? "–¢–∞–∫" : "–ù—ñ"
                    }</p>
                    <p><strong>orderNumber:</strong> ${orderNumber || "–ù—ñ"}</p>
                    ${
                      orderData
                        ? `<h5>–î–µ–∫–æ–¥–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ:</h5><pre>${JSON.stringify(
                            JSON.parse(decodeURIComponent(orderData)),
                            null,
                            2
                          )}</pre>`
                        : ""
                    }
                `;
        } else {
          result.className = "result error";
          result.innerHTML = `
                    <h4>‚ùå URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</h4>
                    <p>–î–æ–¥–∞–π—Ç–µ ?orderData=...&orderNumber=... –¥–æ URL –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è</p>
                `;
        }
      }

      function simulateOrderSuccess() {
        const encodedData = encodeURIComponent(JSON.stringify(testOrderData));
        const url = `/order-success?orderData=${encodedData}&orderNumber=${testOrderData.orderId}`;

        const result = document.getElementById("urlResult");
        result.style.display = "block";
        result.className = "result";
        result.innerHTML = `
                <h4>‚úÖ –°–∏–º—É–ª—è—Ü—ñ—è order-success:</h4>
                <p><strong>URL –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:</strong></p>
                <p><code>${window.location.origin}${url}</code></p>
                <button class="test-button" onclick="window.open('${url}', '_blank')">–í—ñ–¥–∫—Ä–∏—Ç–∏ –≤ –Ω–æ–≤—ñ–π –≤–∫–ª–∞–¥—Ü—ñ</button>
            `;
      }

      function saveToLocalStorage() {
        try {
          localStorage.setItem("lastOrderData", JSON.stringify(testOrderData));

          const result = document.getElementById("storageResult");
          result.style.display = "block";
          result.className = "result";
          result.innerHTML = `
                    <h4>‚úÖ –î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–æ –≤ localStorage</h4>
                    <p>–ö–ª—é—á: <code>lastOrderData</code></p>
                `;
        } catch (error) {
          const result = document.getElementById("storageResult");
          result.style.display = "block";
          result.className = "result error";
          result.innerHTML = `
                    <h4>‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è:</h4>
                    <p>${error.message}</p>
                `;
        }
      }

      function loadFromLocalStorage() {
        try {
          const savedData = localStorage.getItem("lastOrderData");

          const result = document.getElementById("storageResult");
          result.style.display = "block";

          if (savedData) {
            const parsedData = JSON.parse(savedData);
            result.className = "result";
            result.innerHTML = `
                        <h4>‚úÖ –î–∞–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∑ localStorage</h4>
                        <pre>${JSON.stringify(parsedData, null, 2)}</pre>
                    `;
          } else {
            result.className = "result error";
            result.innerHTML = `
                        <h4>‚ùå –î–∞–Ω—ñ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –≤ localStorage</h4>
                        <p>–°–ø–æ—á–∞—Ç–∫—É –∑–±–µ—Ä–µ–∂—ñ—Ç—å –¥–∞–Ω—ñ</p>
                    `;
          }
        } catch (error) {
          const result = document.getElementById("storageResult");
          result.style.display = "block";
          result.className = "result error";
          result.innerHTML = `
                    <h4>‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:</h4>
                    <p>${error.message}</p>
                `;
        }
      }

      function clearLocalStorage() {
        localStorage.removeItem("lastOrderData");
        localStorage.removeItem("testOrderData");

        const result = document.getElementById("storageResult");
        result.style.display = "block";
        result.className = "result";
        result.innerHTML = `
                <h4>‚úÖ localStorage –æ—á–∏—â–µ–Ω–æ</h4>
                <p>–í—Å—ñ —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ –≤–∏–¥–∞–ª–µ–Ω–æ</p>
            `;
      }

      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
      window.onload = function () {
        checkURLParams();
      };
    </script>
  </body>
</html>
